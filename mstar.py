# testing_morningstar_data.py
import os
import morningstar_data as md
import pandas as pd

os.environ['MD_AUTH_TOKEN']="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ik1EY3hOemRHTnpGRFJrSTRPRGswTmtaRU1FSkdOekl5TXpORFJrUTROemd6TWtOR016bEdOdyJ9.eyJodHRwczovL21vcm5pbmdzdGFyLmNvbS9lbWFpbCI6ImlhbkBmMnBhcnRuZXJzLmNvbSIsImh0dHBzOi8vbW9ybmluZ3N0YXIuY29tL3JvbGUiOlsiRW5hYmxlZCBBbmFseXRpY3MgTGFiIERlbGl2ZXJ5IE5vdGVib29rcyIsIkRpc2FibGUgRGVmaW5lZCBDb250cmlidXRpb24gUGxhbnMiLCJEaXJlY3QgSURDIEJvbmQgVXNlcnMiLCJQb3J0Zm9saW8gQW5hbHlzaXMgVXNlciIsIlBlcnNvbmEuRGlyZWN0Rm9yQXNzZXRNYW5hZ2VtZW50IiwiTGljZW5zZS5QcmVzZW50YXRpb25TdHVkaW8iXSwiaHR0cHM6Ly9tb3JuaW5nc3Rhci5jb20vY29tcGFueV9pZCI6ImJkZGNiNmE4LTAyZjItNDMxZi1iZGU2LTM3MmZiNWFlYWJhYyIsImh0dHBzOi8vbW9ybmluZ3N0YXIuY29tL2xlZ2FjeV9jb21wYW55X2lkIjoiYmRkY2I2YTgtMDJmMi00MzFmLWJkZTYtMzcyZmI1YWVhYmFjIiwiaHR0cHM6Ly9tb3JuaW5nc3Rhci5jb20vcm9sZV9pZCI6WyI3OGJhMWFlNy0xZWUzLTQ0YTAtYTAxOC0wOGM1NThmZWNmMTciLCI4MjYyOWNkMC1kZjgwLTRlNWMtYjNiYS02YmQyNWU5MzBhNDIiLCIzMjJlZWI4Ni04NWFmLTQ5NDctYjA1ZC03OTc4NjQ2N2QxNmIiLCJkYzMxN2Q5OC0xMTAwLTQyM2YtOTUzZi1mZjRkYjc4MzUwMTgiXSwiaHR0cHM6Ly9tb3JuaW5nc3Rhci5jb20vcHJvZHVjdCI6WyJESVJFQ1QiLCJQUyJdLCJodHRwczovL21vcm5pbmdzdGFyLmNvbS9jb21wYW55IjpbeyJpZCI6ImJkZGNiNmE4LTAyZjItNDMxZi1iZGU2LTM3MmZiNWFlYWJhYyIsInByb2R1Y3QiOiJESVJFQ1QifV0sImh0dHBzOi8vbW9ybmluZ3N0YXIuY29tL21zdGFyX2lkIjoiRDU5QkQ2RkItQkI2Qi00Rjk0LUFGRDQtQzk0QjVFQ0M0OTgyIiwiaHR0cHM6Ly9tb3JuaW5nc3Rhci5jb20vZW1haWxfdmVyaWZpZWQiOnRydWUsImh0dHBzOi8vbW9ybmluZ3N0YXIuY29tL3Bhc3N3b3JkQ2hhbmdlUmVxdWlyZWQiOmZhbHNlLCJodHRwczovL21vcm5pbmdzdGFyLmNvbS91aW1fcm9sZXMiOiJNRF9NRU1CRVJfMV8xLERJUkVDVCIsImh0dHBzOi8vbW9ybmluZ3N0YXIuY29tL2xhc3RfcGFzc3dvcmRfcmVzZXQiOiIyMDIzLTA0LTEzVDE2OjI2OjU3LjUwMloiLCJpc3MiOiJodHRwczovL2xvZ2luLXByb2QubW9ybmluZ3N0YXIuY29tLyIsInN1YiI6ImF1dGgwfEQ1OUJENkZCLUJCNkItNEY5NC1BRkQ0LUM5NEI1RUNDNDk4MiIsImF1ZCI6WyJodHRwczovL3VpbS1wcm9kLm1vcm5pbmdzdGFyLmF1dGgwLmNvbS9hcGkvdjIvIiwiaHR0cHM6Ly91aW0tcHJvZC5tb3JuaW5nc3Rhci5hdXRoMC5jb20vdXNlcmluZm8iXSwiaWF0IjoxNzM3MjMwNjEyLCJleHAiOjE3MzczMTcwMTIsInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwgb2ZmbGluZV9hY2Nlc3MiLCJhenAiOiJDaGVLTTR1ajhqUFQ2MGFVMkk0Y1BsSDhyREtkT3NaZCJ9.w-eyD0vkZjOjKfUfq7DhPsiXrdK6DenTIY2sPGEkz4seg7rIwSBkDo_bEIeLSZrl1cJO2vSVsih-a579s17CX3X9sGu134CYgw3ek56GCmPGAAS6poADZoOo-vuoj9l1QxBYX60sUIK70igrwK5imfAKePe0qB9DTj5M9SUr2Ga1ThZFC__1EIVzVPrKLxV9LY-pCCDA-uJHKVnpED6uQCKP3F9ZbLhBZdLHzt4KUDLW5eIRpYb4M5ucnnVa6kPOLjwH1A-re9gELkn7146RosimQhXsw2cK_P76ycBePmLrTsjQFsGgnCMTM-MOlIt6V12rHTcKj9gh2iLtdQ5hbA"

md.direct.get_morningstar_data_sets()

#this is unique identifier for the my custom list that houses all open end US Funds
my_mstar_list = "75FBA67A-5641-45D7-A744-5FE1D68D6FFE" 
#this is the unique indentifier for my custom data set
my_data_set = '7831053'     

full_list_of_funds = md.direct.user_items.get_investment_list(my_mstar_list)

tickers = ['MFEIX', 'GCVTX', 'MCVIX', 'MLPOX', 'FEGIX', 'GSINX'] 

first_10_rows = full_list_of_funds.head(10)

database_for_tickers = tickers.isin(full_list_of_funds['tradingsymbol'])

print(database_for_tickers)
#print(first_10_rows)
#print(full_list_of_funds)


#data_sets = md.direct.get_investment_data(my_mstar_list, my_data_set, True, False)
#print(data_sets)